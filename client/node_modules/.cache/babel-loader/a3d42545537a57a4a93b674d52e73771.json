{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { forwardRef, useContext, useLayoutEffect, useMemo, useRef } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { Box } from '../Box';\nimport { Chart, calcs, round } from '../Chart';\nimport { Grid } from '../Grid';\nimport { Stack } from '../Stack';\nvar halfPad = {\n  xlarge: 'large',\n  large: 'medium',\n  medium: 'small',\n  small: 'xsmall',\n  xsmall: 'xxsmall'\n};\nvar doublePad = {\n  large: 'xlarge',\n  medium: 'large',\n  small: 'medium',\n  xsmall: 'small',\n  xxsmall: 'xsmall'\n};\n\nvar checkDateFormat = function checkDateFormat(firstValue, lastValue, full) {\n  var dateFormat;\n  var startDate = new Date(firstValue);\n  var endDate = new Date(lastValue);\n\n  if ( // check for valid dates, this is the fastest way\n  !Number.isNaN(startDate.getTime()) && !Number.isNaN(endDate.getTime())) {\n    var delta = Math.abs(endDate - startDate);\n    var options;\n    if (delta < 60000) // less than 1 minute\n      options = full ? {\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        day: undefined\n      } : {\n        second: '2-digit',\n        day: undefined\n      };else if (delta < 3600000) // less than 1 hour\n      options = full ? {\n        hour: 'numeric',\n        minute: '2-digit',\n        day: undefined\n      } : {\n        minute: '2-digit',\n        day: undefined\n      };else if (delta < 86400000) // less than 1 day\n      options = {\n        hour: 'numeric'\n      };else if (delta < 2592000000) // less than 30 days\n      options = {\n        month: full ? 'short' : 'numeric',\n        day: 'numeric'\n      };else if (delta < 31557600000) // less than 1 year\n      options = {\n        month: full ? 'long' : 'short'\n      }; // 1 year or more\n    else options = {\n        year: 'numeric'\n      };\n    if (options) dateFormat = new Intl.DateTimeFormat(undefined, options).format;\n  }\n\n  return dateFormat;\n};\n\nvar DataChart = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      chart = _ref.chart,\n      data = _ref.data,\n      padProp = _ref.pad,\n      size = _ref.size,\n      thicknessProp = _ref.thickness,\n      xAxis = _ref.xAxis,\n      yAxis = _ref.yAxis,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"a11yTitle\", \"chart\", \"data\", \"pad\", \"size\", \"thickness\", \"xAxis\", \"yAxis\"]);\n\n  console.warn(\"The DataChart component is still experimental.\\n      It is not guaranteed to be backwards compatible until it is explicitly\\n      released. Keep an eye on the release notes and #announcements channel\\n      in Slack.\");\n  var theme = useContext(ThemeContext); // refs used for ie11 not having Grid\n\n  var xRef = useRef();\n  var spacerRef = useRef(); // normalize chart to an array\n\n  var charts = useMemo(function () {\n    return Array.isArray(chart) ? chart : [chart];\n  }, [chart]); // map the key values into their own arrays\n\n  var keyValues = useMemo(function () {\n    var result = {};\n    charts.forEach(function (_ref2) {\n      var key = _ref2.key,\n          keys = _ref2.keys;\n\n      if (key && !result[key]) {\n        result[key] = data.map(function (d) {\n          return d[key];\n        });\n      }\n\n      if (keys) {\n        keys.forEach(function (_ref3) {\n          var innerKey = _ref3.key;\n\n          if (innerKey && !result[innerKey]) {\n            result[innerKey] = data.map(function (d) {\n              return d[innerKey];\n            });\n          }\n        });\n      }\n    });\n    return result;\n  }, [charts, data]);\n  var numValues = useMemo(function () {\n    return keyValues[Object.keys(keyValues)[0]].length;\n  }, [keyValues]); // setup the values for each chart\n\n  var chartValues = useMemo(function () {\n    return charts.map(function (_ref4) {\n      var key = _ref4.key,\n          keys = _ref4.keys;\n      if (key) return keyValues[key];\n\n      if (keys) {\n        var totals = [];\n        return keys.map(function (_ref5) {\n          var innerKey = _ref5.key;\n          return keyValues[innerKey].map(function (v, i) {\n            var base = totals[i] || 0;\n            totals[i] = base + v;\n            return [i, base, base + v];\n          });\n        });\n      }\n\n      return [];\n    });\n  }, [charts, keyValues]); // calculate axis, bounds and thickness\n\n  var _useMemo = useMemo(function () {\n    var steps = [];\n    if (xAxis && xAxis.labels >= 0) steps[0] = xAxis.labels - 1;else steps[0] = numValues - 1; // all\n\n    if (yAxis && yAxis.labels >= 0) steps[1] = yAxis.labels - 1;else steps[1] = 1; // ends\n\n    var tmpAxis = [[], []];\n    var tmpBounds;\n    var tmpThickness = thicknessProp;\n    charts.forEach(function (_ref6, index) {\n      var keys = _ref6.keys;\n      (keys ? chartValues[index] : [chartValues[index]]).filter(function (vals) {\n        return vals && vals.length > 0;\n      }).forEach(function (vals) {\n        var _calcs = calcs(vals, {\n          steps: steps,\n          thickness: tmpThickness\n        }),\n            a = _calcs.axis,\n            b = _calcs.bounds,\n            t = _calcs.thickness;\n\n        tmpAxis = a;\n        tmpBounds = b;\n        tmpThickness = t;\n      });\n    });\n    return {\n      axis: tmpAxis,\n      bounds: tmpBounds,\n      thickness: tmpThickness\n    };\n  }, [charts, chartValues, numValues, thicknessProp, xAxis, yAxis]),\n      axis = _useMemo.axis,\n      bounds = _useMemo.bounds,\n      thickness = _useMemo.thickness; // set the pad to have the thickness, if not defined\n\n\n  var pad = useMemo(function () {\n    if (padProp !== undefined) return padProp;\n    var padSize = halfPad[thickness];\n    var allSides = charts.filter(function (_ref7) {\n      var type = _ref7.type;\n      return type && type !== 'bar';\n    }).length > 0;\n    if (allSides) return padSize;\n    if (yAxis) return {\n      horizontal: padSize,\n      vertical: halfPad.medium\n    };\n    return {\n      horizontal: padSize\n    };\n  }, [charts, padProp, thickness, yAxis]);\n  var xGuide = useMemo(function () {\n    return axis[0].map(function (_, i) {\n      if (xAxis && xAxis.guide) {\n        if (i === 0) return 'left';\n        if (i === axis[0].length - 1) return 'right';\n      }\n\n      return undefined;\n    });\n  }, [axis, xAxis]);\n  var yGuide = useMemo(function () {\n    return axis[1].map(function (_, i) {\n      if (yAxis && yAxis.guide) {\n        if (i === 0) return 'top';\n        if (i === axis[1].length - 1) return 'bottom';\n      }\n\n      return undefined;\n    });\n  }, [axis, yAxis]); // for ie11, align the spacer Box height to the x-axis height\n\n  useLayoutEffect(function () {\n    if (xRef.current && spacerRef.current) {\n      var rect = xRef.current.getBoundingClientRect();\n      spacerRef.current.style.height = rect.height + \"px\";\n    }\n  }, []);\n  /* eslint-disable react/no-array-index-key */\n\n  var xAxisElement;\n\n  if (xAxis) {\n    // Set basis to match thickness. This works well for bar charts,\n    // to align each bar's label.\n    var basis;\n\n    if (thickness && axis[0].length === numValues) {\n      basis = theme.global.edgeSize[thickness] || thickness;\n    } // If there is no custom renderer, there is a key, and the key value\n    // looks like a Date, render it as a date, scaled based on the range\n    // of values\n\n\n    var dateFormat;\n\n    if (!xAxis.render && xAxis.key && axis[0].length > 1) {\n      dateFormat = checkDateFormat(data[Math.floor(axis[0][0])][xAxis.key], data[Math.floor(axis[0][axis[0].length - 1])][xAxis.key], axis[0].length <= 2);\n    }\n\n    xAxisElement = /*#__PURE__*/React.createElement(Box, {\n      ref: xRef,\n      gridArea: \"xAxis\",\n      direction: \"row\",\n      justify: \"between\"\n    }, axis[0].map(function (dataIndex, i) {\n      var content = xAxis.key ? data[Math.floor(dataIndex)][xAxis.key] : dataIndex;\n      if (xAxis.render) content = xAxis.render(content, data, Math.floor(dataIndex), i);else if (dateFormat) content = dateFormat(new Date(content));\n      return /*#__PURE__*/React.createElement(Box, {\n        key: i,\n        basis: basis,\n        flex: \"shrink\",\n        align: basis ? 'center' : undefined\n      }, content);\n    }));\n  }\n\n  var yAxisElement;\n\n  if (yAxis) {\n    var divideBy;\n    var unit;\n\n    if (!yAxis.render && !yAxis.suffix) {\n      // figure out how many digits to show\n      var maxValue = Math.max.apply(Math, axis[1].map(function (v) {\n        return Math.abs(v);\n      }));\n\n      if (maxValue > 10000000) {\n        divideBy = 1000000;\n        unit = 'M';\n      } else if (maxValue > 10000) {\n        divideBy = 1000;\n        unit = 'K';\n      }\n    } // Set basis to match double the vertical pad, so we can align the\n    // text with the guides\n\n\n    var _basis;\n\n    if (axis[0].length === numValues) {\n      var edgeSize = doublePad[pad.vertical || pad];\n      _basis = theme.global.edgeSize[edgeSize] || edgeSize;\n    }\n\n    yAxisElement = /*#__PURE__*/React.createElement(Box, {\n      gridArea: \"yAxis\",\n      justify: \"between\",\n      flex: true\n    }, axis[1].map(function (axisValue, i) {\n      var content;\n      if (yAxis.render) content = yAxis.render(axisValue, i);else {\n        content = axisValue;\n\n        if (divideBy) {\n          content = round(content / divideBy, 0);\n        }\n\n        if (yAxis.prefix) content = \"\" + yAxis.prefix + content;\n        if (yAxis.suffix || unit) content = \"\" + content + (yAxis.suffix || unit);\n      }\n      return /*#__PURE__*/React.createElement(Box, {\n        key: i,\n        align: \"end\",\n        basis: _basis,\n        flex: \"shrink\",\n        justify: _basis ? 'center' : undefined\n      }, content);\n    }));\n  }\n\n  var stackFill = useMemo(function () {\n    if (size === 'fill' || size && size.width === 'fill' && size.height === 'fill') return true;\n    if (size && size.width === 'fill') return 'horizontal';\n    if (size && size.height === 'fill') return 'vertical';\n    return undefined;\n  }, [size]);\n  var stackElement = /*#__PURE__*/React.createElement(Stack, {\n    gridArea: \"charts\",\n    guidingChild: \"last\",\n    fill: stackFill\n  }, xAxis && xAxis.guide && /*#__PURE__*/React.createElement(Box, {\n    fill: true,\n    direction: \"row\",\n    justify: \"between\",\n    pad: pad,\n    responsive: false\n  }, xGuide.map(function (_, i) {\n    return /*#__PURE__*/React.createElement(Box, {\n      key: i,\n      border: \"left\"\n    });\n  })), yAxis && yAxis.guide && /*#__PURE__*/React.createElement(Box, {\n    fill: true,\n    justify: \"between\",\n    pad: pad,\n    responsive: false\n  }, yGuide.map(function (_, i) {\n    return /*#__PURE__*/React.createElement(Box, {\n      key: i,\n      border: \"top\"\n    });\n  })), charts.map(function (_ref8, i) {\n    var key = _ref8.key,\n        keys = _ref8.keys,\n        chartRest = _objectWithoutPropertiesLoose(_ref8, [\"key\", \"keys\"]);\n\n    if (keys) {\n      // reverse to ensure area Charts are stacked in the right order\n      return keys.map(function (_, j) {\n        return /*#__PURE__*/React.createElement(Chart, _extends({\n          key: j,\n          values: chartValues[i][j],\n          color: keys[j].color,\n          bounds: bounds,\n          overflow: true,\n          pad: pad,\n          size: size,\n          thickness: thickness\n        }, chartRest));\n      }).reverse();\n    }\n\n    return /*#__PURE__*/React.createElement(Chart, _extends({\n      key: i,\n      values: chartValues[i],\n      bounds: bounds,\n      overflow: true,\n      pad: pad,\n      size: size,\n      thickness: thickness\n    }, chartRest));\n  })); // IE11\n\n  if (!Grid.available) {\n    var content = stackElement;\n\n    if (xAxisElement) {\n      content = /*#__PURE__*/React.createElement(Box, null, content, xAxisElement);\n    }\n\n    if (yAxisElement) {\n      content = /*#__PURE__*/React.createElement(Box, {\n        direction: \"row\"\n      }, /*#__PURE__*/React.createElement(Box, null, yAxisElement, /*#__PURE__*/React.createElement(Box, {\n        ref: spacerRef,\n        flex: false\n      })), content);\n    }\n\n    return content;\n  }\n\n  return /*#__PURE__*/React.createElement(Grid, _extends({\n    ref: ref,\n    \"aria-label\": a11yTitle,\n    fill: stackFill,\n    columns: ['auto', stackFill === true || stackFill === 'horizontal' ? 'flex' : 'auto'],\n    rows: [stackFill === true || stackFill === 'vertical' ? 'flex' : 'auto', 'auto'],\n    areas: [{\n      name: 'yAxis',\n      start: [0, 0],\n      end: [0, 0]\n    }, {\n      name: 'xAxis',\n      start: [1, 1],\n      end: [1, 1]\n    }, {\n      name: 'charts',\n      start: [1, 0],\n      end: [1, 0]\n    }]\n  }, rest), xAxisElement, yAxisElement, stackElement);\n});\nDataChart.displayName = 'DataChart';\nvar DataChartDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  // eslint-disable-next-line global-require\n  DataChartDoc = require('./doc').doc(DataChart);\n}\n\nvar DataChartWrapper = DataChartDoc || DataChart;\nexport { DataChartWrapper as DataChart };","map":{"version":3,"sources":["/Users/tessie/Documents/mediary-graphql/client/node_modules/grommet/es6/components/DataChart/DataChart.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","forwardRef","useContext","useLayoutEffect","useMemo","useRef","ThemeContext","Box","Chart","calcs","round","Grid","Stack","halfPad","xlarge","large","medium","small","xsmall","doublePad","xxsmall","checkDateFormat","firstValue","lastValue","full","dateFormat","startDate","Date","endDate","Number","isNaN","getTime","delta","Math","abs","options","hour","minute","second","day","undefined","month","year","Intl","DateTimeFormat","format","DataChart","_ref","ref","a11yTitle","chart","data","padProp","pad","size","thicknessProp","thickness","xAxis","yAxis","rest","console","warn","theme","xRef","spacerRef","charts","Array","isArray","keyValues","result","forEach","_ref2","map","d","_ref3","innerKey","numValues","chartValues","_ref4","totals","_ref5","v","base","_useMemo","steps","labels","tmpAxis","tmpBounds","tmpThickness","_ref6","index","filter","vals","_calcs","a","axis","b","bounds","t","padSize","allSides","_ref7","type","horizontal","vertical","xGuide","_","guide","yGuide","current","rect","getBoundingClientRect","style","height","xAxisElement","basis","global","edgeSize","render","floor","createElement","gridArea","direction","justify","dataIndex","content","flex","align","yAxisElement","divideBy","unit","suffix","maxValue","max","_basis","axisValue","prefix","stackFill","width","stackElement","guidingChild","fill","responsive","border","_ref8","chartRest","j","values","color","overflow","reverse","available","columns","rows","areas","name","start","end","displayName","DataChartDoc","process","env","NODE_ENV","require","doc","DataChartWrapper"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef, useContext, useLayoutEffect, useMemo, useRef } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { Box } from '../Box';\nimport { Chart, calcs, round } from '../Chart';\nimport { Grid } from '../Grid';\nimport { Stack } from '../Stack';\nvar halfPad = {\n  xlarge: 'large',\n  large: 'medium',\n  medium: 'small',\n  small: 'xsmall',\n  xsmall: 'xxsmall'\n};\nvar doublePad = {\n  large: 'xlarge',\n  medium: 'large',\n  small: 'medium',\n  xsmall: 'small',\n  xxsmall: 'xsmall'\n};\n\nvar checkDateFormat = function checkDateFormat(firstValue, lastValue, full) {\n  var dateFormat;\n  var startDate = new Date(firstValue);\n  var endDate = new Date(lastValue);\n\n  if ( // check for valid dates, this is the fastest way\n  !Number.isNaN(startDate.getTime()) && !Number.isNaN(endDate.getTime())) {\n    var delta = Math.abs(endDate - startDate);\n    var options;\n    if (delta < 60000) // less than 1 minute\n      options = full ? {\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        day: undefined\n      } : {\n        second: '2-digit',\n        day: undefined\n      };else if (delta < 3600000) // less than 1 hour\n      options = full ? {\n        hour: 'numeric',\n        minute: '2-digit',\n        day: undefined\n      } : {\n        minute: '2-digit',\n        day: undefined\n      };else if (delta < 86400000) // less than 1 day\n      options = {\n        hour: 'numeric'\n      };else if (delta < 2592000000) // less than 30 days\n      options = {\n        month: full ? 'short' : 'numeric',\n        day: 'numeric'\n      };else if (delta < 31557600000) // less than 1 year\n      options = {\n        month: full ? 'long' : 'short'\n      }; // 1 year or more\n    else options = {\n        year: 'numeric'\n      };\n    if (options) dateFormat = new Intl.DateTimeFormat(undefined, options).format;\n  }\n\n  return dateFormat;\n};\n\nvar DataChart = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      chart = _ref.chart,\n      data = _ref.data,\n      padProp = _ref.pad,\n      size = _ref.size,\n      thicknessProp = _ref.thickness,\n      xAxis = _ref.xAxis,\n      yAxis = _ref.yAxis,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"a11yTitle\", \"chart\", \"data\", \"pad\", \"size\", \"thickness\", \"xAxis\", \"yAxis\"]);\n\n  console.warn(\"The DataChart component is still experimental.\\n      It is not guaranteed to be backwards compatible until it is explicitly\\n      released. Keep an eye on the release notes and #announcements channel\\n      in Slack.\");\n  var theme = useContext(ThemeContext); // refs used for ie11 not having Grid\n\n  var xRef = useRef();\n  var spacerRef = useRef(); // normalize chart to an array\n\n  var charts = useMemo(function () {\n    return Array.isArray(chart) ? chart : [chart];\n  }, [chart]); // map the key values into their own arrays\n\n  var keyValues = useMemo(function () {\n    var result = {};\n    charts.forEach(function (_ref2) {\n      var key = _ref2.key,\n          keys = _ref2.keys;\n\n      if (key && !result[key]) {\n        result[key] = data.map(function (d) {\n          return d[key];\n        });\n      }\n\n      if (keys) {\n        keys.forEach(function (_ref3) {\n          var innerKey = _ref3.key;\n\n          if (innerKey && !result[innerKey]) {\n            result[innerKey] = data.map(function (d) {\n              return d[innerKey];\n            });\n          }\n        });\n      }\n    });\n    return result;\n  }, [charts, data]);\n  var numValues = useMemo(function () {\n    return keyValues[Object.keys(keyValues)[0]].length;\n  }, [keyValues]); // setup the values for each chart\n\n  var chartValues = useMemo(function () {\n    return charts.map(function (_ref4) {\n      var key = _ref4.key,\n          keys = _ref4.keys;\n      if (key) return keyValues[key];\n\n      if (keys) {\n        var totals = [];\n        return keys.map(function (_ref5) {\n          var innerKey = _ref5.key;\n          return keyValues[innerKey].map(function (v, i) {\n            var base = totals[i] || 0;\n            totals[i] = base + v;\n            return [i, base, base + v];\n          });\n        });\n      }\n\n      return [];\n    });\n  }, [charts, keyValues]); // calculate axis, bounds and thickness\n\n  var _useMemo = useMemo(function () {\n    var steps = [];\n    if (xAxis && xAxis.labels >= 0) steps[0] = xAxis.labels - 1;else steps[0] = numValues - 1; // all\n\n    if (yAxis && yAxis.labels >= 0) steps[1] = yAxis.labels - 1;else steps[1] = 1; // ends\n\n    var tmpAxis = [[], []];\n    var tmpBounds;\n    var tmpThickness = thicknessProp;\n    charts.forEach(function (_ref6, index) {\n      var keys = _ref6.keys;\n      (keys ? chartValues[index] : [chartValues[index]]).filter(function (vals) {\n        return vals && vals.length > 0;\n      }).forEach(function (vals) {\n        var _calcs = calcs(vals, {\n          steps: steps,\n          thickness: tmpThickness\n        }),\n            a = _calcs.axis,\n            b = _calcs.bounds,\n            t = _calcs.thickness;\n\n        tmpAxis = a;\n        tmpBounds = b;\n        tmpThickness = t;\n      });\n    });\n    return {\n      axis: tmpAxis,\n      bounds: tmpBounds,\n      thickness: tmpThickness\n    };\n  }, [charts, chartValues, numValues, thicknessProp, xAxis, yAxis]),\n      axis = _useMemo.axis,\n      bounds = _useMemo.bounds,\n      thickness = _useMemo.thickness; // set the pad to have the thickness, if not defined\n\n\n  var pad = useMemo(function () {\n    if (padProp !== undefined) return padProp;\n    var padSize = halfPad[thickness];\n    var allSides = charts.filter(function (_ref7) {\n      var type = _ref7.type;\n      return type && type !== 'bar';\n    }).length > 0;\n    if (allSides) return padSize;\n    if (yAxis) return {\n      horizontal: padSize,\n      vertical: halfPad.medium\n    };\n    return {\n      horizontal: padSize\n    };\n  }, [charts, padProp, thickness, yAxis]);\n  var xGuide = useMemo(function () {\n    return axis[0].map(function (_, i) {\n      if (xAxis && xAxis.guide) {\n        if (i === 0) return 'left';\n        if (i === axis[0].length - 1) return 'right';\n      }\n\n      return undefined;\n    });\n  }, [axis, xAxis]);\n  var yGuide = useMemo(function () {\n    return axis[1].map(function (_, i) {\n      if (yAxis && yAxis.guide) {\n        if (i === 0) return 'top';\n        if (i === axis[1].length - 1) return 'bottom';\n      }\n\n      return undefined;\n    });\n  }, [axis, yAxis]); // for ie11, align the spacer Box height to the x-axis height\n\n  useLayoutEffect(function () {\n    if (xRef.current && spacerRef.current) {\n      var rect = xRef.current.getBoundingClientRect();\n      spacerRef.current.style.height = rect.height + \"px\";\n    }\n  }, []);\n  /* eslint-disable react/no-array-index-key */\n\n  var xAxisElement;\n\n  if (xAxis) {\n    // Set basis to match thickness. This works well for bar charts,\n    // to align each bar's label.\n    var basis;\n\n    if (thickness && axis[0].length === numValues) {\n      basis = theme.global.edgeSize[thickness] || thickness;\n    } // If there is no custom renderer, there is a key, and the key value\n    // looks like a Date, render it as a date, scaled based on the range\n    // of values\n\n\n    var dateFormat;\n\n    if (!xAxis.render && xAxis.key && axis[0].length > 1) {\n      dateFormat = checkDateFormat(data[Math.floor(axis[0][0])][xAxis.key], data[Math.floor(axis[0][axis[0].length - 1])][xAxis.key], axis[0].length <= 2);\n    }\n\n    xAxisElement = /*#__PURE__*/React.createElement(Box, {\n      ref: xRef,\n      gridArea: \"xAxis\",\n      direction: \"row\",\n      justify: \"between\"\n    }, axis[0].map(function (dataIndex, i) {\n      var content = xAxis.key ? data[Math.floor(dataIndex)][xAxis.key] : dataIndex;\n      if (xAxis.render) content = xAxis.render(content, data, Math.floor(dataIndex), i);else if (dateFormat) content = dateFormat(new Date(content));\n      return /*#__PURE__*/React.createElement(Box, {\n        key: i,\n        basis: basis,\n        flex: \"shrink\",\n        align: basis ? 'center' : undefined\n      }, content);\n    }));\n  }\n\n  var yAxisElement;\n\n  if (yAxis) {\n    var divideBy;\n    var unit;\n\n    if (!yAxis.render && !yAxis.suffix) {\n      // figure out how many digits to show\n      var maxValue = Math.max.apply(Math, axis[1].map(function (v) {\n        return Math.abs(v);\n      }));\n\n      if (maxValue > 10000000) {\n        divideBy = 1000000;\n        unit = 'M';\n      } else if (maxValue > 10000) {\n        divideBy = 1000;\n        unit = 'K';\n      }\n    } // Set basis to match double the vertical pad, so we can align the\n    // text with the guides\n\n\n    var _basis;\n\n    if (axis[0].length === numValues) {\n      var edgeSize = doublePad[pad.vertical || pad];\n      _basis = theme.global.edgeSize[edgeSize] || edgeSize;\n    }\n\n    yAxisElement = /*#__PURE__*/React.createElement(Box, {\n      gridArea: \"yAxis\",\n      justify: \"between\",\n      flex: true\n    }, axis[1].map(function (axisValue, i) {\n      var content;\n      if (yAxis.render) content = yAxis.render(axisValue, i);else {\n        content = axisValue;\n\n        if (divideBy) {\n          content = round(content / divideBy, 0);\n        }\n\n        if (yAxis.prefix) content = \"\" + yAxis.prefix + content;\n        if (yAxis.suffix || unit) content = \"\" + content + (yAxis.suffix || unit);\n      }\n      return /*#__PURE__*/React.createElement(Box, {\n        key: i,\n        align: \"end\",\n        basis: _basis,\n        flex: \"shrink\",\n        justify: _basis ? 'center' : undefined\n      }, content);\n    }));\n  }\n\n  var stackFill = useMemo(function () {\n    if (size === 'fill' || size && size.width === 'fill' && size.height === 'fill') return true;\n    if (size && size.width === 'fill') return 'horizontal';\n    if (size && size.height === 'fill') return 'vertical';\n    return undefined;\n  }, [size]);\n  var stackElement = /*#__PURE__*/React.createElement(Stack, {\n    gridArea: \"charts\",\n    guidingChild: \"last\",\n    fill: stackFill\n  }, xAxis && xAxis.guide && /*#__PURE__*/React.createElement(Box, {\n    fill: true,\n    direction: \"row\",\n    justify: \"between\",\n    pad: pad,\n    responsive: false\n  }, xGuide.map(function (_, i) {\n    return /*#__PURE__*/React.createElement(Box, {\n      key: i,\n      border: \"left\"\n    });\n  })), yAxis && yAxis.guide && /*#__PURE__*/React.createElement(Box, {\n    fill: true,\n    justify: \"between\",\n    pad: pad,\n    responsive: false\n  }, yGuide.map(function (_, i) {\n    return /*#__PURE__*/React.createElement(Box, {\n      key: i,\n      border: \"top\"\n    });\n  })), charts.map(function (_ref8, i) {\n    var key = _ref8.key,\n        keys = _ref8.keys,\n        chartRest = _objectWithoutPropertiesLoose(_ref8, [\"key\", \"keys\"]);\n\n    if (keys) {\n      // reverse to ensure area Charts are stacked in the right order\n      return keys.map(function (_, j) {\n        return /*#__PURE__*/React.createElement(Chart, _extends({\n          key: j,\n          values: chartValues[i][j],\n          color: keys[j].color,\n          bounds: bounds,\n          overflow: true,\n          pad: pad,\n          size: size,\n          thickness: thickness\n        }, chartRest));\n      }).reverse();\n    }\n\n    return /*#__PURE__*/React.createElement(Chart, _extends({\n      key: i,\n      values: chartValues[i],\n      bounds: bounds,\n      overflow: true,\n      pad: pad,\n      size: size,\n      thickness: thickness\n    }, chartRest));\n  })); // IE11\n\n  if (!Grid.available) {\n    var content = stackElement;\n\n    if (xAxisElement) {\n      content = /*#__PURE__*/React.createElement(Box, null, content, xAxisElement);\n    }\n\n    if (yAxisElement) {\n      content = /*#__PURE__*/React.createElement(Box, {\n        direction: \"row\"\n      }, /*#__PURE__*/React.createElement(Box, null, yAxisElement, /*#__PURE__*/React.createElement(Box, {\n        ref: spacerRef,\n        flex: false\n      })), content);\n    }\n\n    return content;\n  }\n\n  return /*#__PURE__*/React.createElement(Grid, _extends({\n    ref: ref,\n    \"aria-label\": a11yTitle,\n    fill: stackFill,\n    columns: ['auto', stackFill === true || stackFill === 'horizontal' ? 'flex' : 'auto'],\n    rows: [stackFill === true || stackFill === 'vertical' ? 'flex' : 'auto', 'auto'],\n    areas: [{\n      name: 'yAxis',\n      start: [0, 0],\n      end: [0, 0]\n    }, {\n      name: 'xAxis',\n      start: [1, 1],\n      end: [1, 1]\n    }, {\n      name: 'charts',\n      start: [1, 0],\n      end: [1, 0]\n    }]\n  }, rest), xAxisElement, yAxisElement, stackElement);\n});\nDataChart.displayName = 'DataChart';\nvar DataChartDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  // eslint-disable-next-line global-require\n  DataChartDoc = require('./doc').doc(DataChart);\n}\n\nvar DataChartWrapper = DataChartDoc || DataChart;\nexport { DataChartWrapper as DataChart };"]},"metadata":{},"sourceType":"module"}